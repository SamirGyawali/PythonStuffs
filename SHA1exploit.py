# strip() removes leading and ending backspaces of the strings if any
# encode() converts string into different representation (bytes like object) that is required by hashing algo like utf-8
# hexdigest() representing hash value in human readable format. converting binary digest into hexadecimal digest


import hashlib
def convert_text_to_sha1(text):
    digest = hashlib.sha1(text.encode()).hexdigest()
    return digest


def main():
    user_sha1 = input("Enter sha1 hash to crack: ")
    clean_user_sha1 = user_sha1.strip().lower()

    with open('passwords.txt') as password_file:
        for line in password_file:
            password = line.strip()
            converted_sha1 = convert_text_to_sha1(password)
            if(clean_user_sha1 == converted_sha1):
                print(f"Found password = {password}")
                return
        print(f"Not found!")



if __name__ == '__main__':
    main()